#!/bin/bash
DAILY_PATH=~/Documents/Notes/daily
task_bin=~/Tools/Tasks/task

taskfile_build () {
    export TASKS_OUTPUT="/tmp/$(date +%F).taskfile"
    $task_bin "$@" list >| $TASKS_OUTPUT
}

tasks () {
    $task_bin edit "$@"
}

task_progress () {
    shift
    start_date="$(date +%F)"
    [[ -z "$1" ]] && echo "Daily Total"
    [[ "-w" == "$1" ]] && echo "Weekly Total" && start_date="$(date -d "Last Sunday" +%F)"
    [[ "-m" == "$1" ]] && echo "Monthly Total" && start_date="$(date +%Y-%m-01)"
    [[ "-y" == "$1" ]] && echo "Annual Total" && start_date="$(date +%Y-01-01)"
    iter_date=$(date -d "$start_date" +%s)
    curr_date="$(date +%s)"
    while [ $iter_date -lt $curr_date ]
    do
        echo "$(date -d @"$iter_date" +%F)"
        rg --vimgrep -e '::start \[\['"$(date -d @"$iter_date" +%F)"'\]\] [0-9]{2}:[0-9]{2}' ~/Documents/Notes
        iter_date="$(( "$iter_date" + 3600*24))"
    done
}
